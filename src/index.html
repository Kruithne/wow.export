<!DOCTYPE html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<script defer type="text/javascript" src="app.js"></script>
		<link rel="stylesheet" type="text/css" data-href="app.css" href="app.css"/>
		<title>wow.export</title>
	</head>
	<body>
		<div id="logo-background"></div>
		<div id="container" v-cloak>
			<div id="header" :class="{ shadowed: toast !== null }">
				<div id="logo" @click="setScreen(screen && screen.startsWith('legacy-') ? 'legacy-tab-home' : 'tab-home')" :class="{ active: screen === 'tab-home' || screen === 'legacy-tab-home' }" style="cursor: pointer;">wow.export</div>
				<div id="nav">
					<template v-if="!!screen && screen.startsWith('tab-')">
						<div class="option nav-models" id="nav-models" @click="setScreen('tab-models')" :class="{ active: screen === 'tab-models' }">Models</div>
						<div class="option nav-characters" id="nav-characters" @click="setScreen('tab-characters')" :class="{ active: screen === 'tab-characters' }">Characters</div>
						<div class="option nav-items" id="nav-items" @click="setScreen('tab-items')" :class="{ active: screen === 'tab-items' }">Items</div>
						<div class="option nav-textures" id="nav-textures" @click="setScreen('tab-textures')" :class="{ active: screen === 'tab-textures' }">Textures</div>
						<div class="option nav-sounds" id="nav-sounds" @click="setScreen('tab-sounds')" :class="{ active: screen === 'tab-sounds' }">Audio</div>
						<div class="option nav-videos" id="nav-videos" @click="setScreen('tab-video')" :class="{ active: screen === 'tab-video' }">Videos</div>
						<div class="option nav-maps" id="nav-maps" @click="setScreen('tab-maps')" :class="{ active: screen === 'tab-maps' }">Maps</div>
						<div class="option nav-zones" id="nav-zones" @click="setScreen('tab-zones')" :class="{ active: screen === 'tab-zones' }">Zones</div>
						<div class="option nav-text" id="nav-text" @click="setScreen('tab-text')" :class="{ active: screen === 'tab-text' }">Text</div>
						<div class="option nav-data" id="nav-data" @click="setScreen('tab-data')" :class="{ active: screen === 'tab-data' }">Data</div>
					</template>
					<template v-if="!!screen && screen.startsWith('legacy-')">
						<div class="option nav-models" id="nav-legacy-models" @click="setScreen('legacy-tab-models')" :class="{ active: screen === 'legacy-tab-models' }">Models</div>
						<div class="option nav-textures" id="nav-legacy-textures" @click="setScreen('legacy-tab-textures')" :class="{ active: screen === 'legacy-tab-textures' }">Textures</div>
						<div class="option nav-sounds" id="nav-legacy-sounds" @click="setScreen('legacy-tab-sounds')" :class="{ active: screen === 'legacy-tab-sounds' }">Sounds</div>
						<div class="option nav-files" id="nav-legacy-files" @click="setScreen('legacy-tab-files')" :class="{ active: screen === 'legacy-tab-files' }">Files</div>
					</template>
					<div id="nav-help" v-if="!isBusy" @click="setScreen('help', true)"></div>
					<div id="nav-extra" v-if="!isBusy" @click="contextMenus.stateNavExtra = true"></div>
					<context-menu @close="contextMenus.stateNavExtra = false" :node="contextMenus.stateNavExtra" id="menu-extra">
						<span @click.self="setScreen('blender', true)" id="menu-extra-blender">Install Blender Add-on</span>
						<span @click.self="setScreen('changelog', true)" id="menu-extra-changes">View Recent Changes</span>
						<span @click.self="openRuntimeLog" id="menu-extra-log">Open Runtime Log</span>
						<span v-if="casc !== null" @click.self="setScreen('tab-raw')" id="menu-extra-raw">Browse Raw Client Files</span>
						<span v-if="casc !== null" @click.self="setScreen('tab-install')" id="menu-extra-install">Browse Install Manifest</span>
						<span @click.self="setScreen('config', true)" id="menu-extra-settings">Manage Settings</span>
						<span @click.self="restartApplication" id="menu-extra-restart">Restart wow.export</span>
						<span v-if="isDev" @click.self="runIntegrationTests" id="menu-extra-tests">Run Integration Tests</span>
						<span v-if="isDev" @click.self="reloadStylesheet" id="menu-extra-style">Reload Styling</span>
						<span @click.self="setScreen('help', true)" id="menu-extra-help">Help</span>
					</context-menu>
				</div>
			</div>
			<div id="drop-overlay" v-if="!!fileDropPrompt">
				<div id="drop-overlay-icon"></div>
				<div id="drop-overlay-text">» {{ fileDropPrompt }} «</div>
			</div>
			<div id="content">
				<div id="loading" v-if="screen === 'loading'">
					<div id="loading-background" :class="{ xmas: isXmas }"></div>
					<div id="loading-icon"></div>
					<span id="loading-title">{{ loadingTitle }}</span>
					<span id="loading-progress">{{ loadingProgress }}</span>
					<div id="loading-bar">
						<div :style="{ width: (loadPct * 100) + '%' }"></div>
					</div>
				</div>
				<div id="changelog" v-if="screen === 'changelog'">
					<h1>Changelog</h1>
					<markdown-content id="changelog-text" :content="changelogText"></markdown-content>
					<input type="button" value="Go Back" @click="showPreviousScreen"/>
				</div>
				<div id="blender-info" v-if="screen === 'blender'">
					<div id="blender-info-header">
						<h1>Installing the wow.export Add-on for Blender 2.8+</h1>
						<p>Blender users can make use of our special importer add-on which makes importing advanced objects as simple as a single click. WMO objects are imported with any exported doodad sets included. ADT map tiles are imported complete with all WMOs and doodads positioned as they would be in-game.</p>
					</div>
					<div id="blender-info-buttons">
						<input type="button" value="Install Automatically (Recommended)" @click="installBlenderAddon" :class="{ disabled: isBusy }"/>
						<input type="button" value="Install Manually (Advanced)" @click="openBlenderAddonFolder"/>
						<input type="button" value="Go Back" @click="showPreviousScreen"/>
					</div>
				</div>
				<div id="help-screen" v-if="screen === 'help'">
					<div class="help-list-container">
						<h1>Help</h1>
						<div class="filter">
							<input type="text" v-model="helpSearchQuery" placeholder="Search help articles..."/>
						</div>
						<div id="help-articles">
							<div v-for="article in helpFilteredArticles" @click="helpSelectedArticle = article" class="help-article-item" :class="{ selected: helpSelectedArticle === article }">
								<div class="help-article-title">{{ article.title }}</div>
								<div class="help-article-tags">
									<span v-if="article.kb_id" class="help-kb-id">{{ article.kb_id }}</span>
									<span>{{ article.tags.join(', ') }}</span>
								</div>
							</div>
						</div>
					</div>
					<div class="help-article-container">
						<markdown-content v-if="helpSelectedArticle" :content="helpSelectedArticle.body"></markdown-content>
						<div v-else class="help-placeholder">Select an article to view</div>
					</div>
					<input type="button" value="Go Back" @click="showPreviousScreen"/>
				</div>
				<div id="config" v-if="screen === 'config'" :class="{ toastgap: toast !== null }">
					<div>
						<h1>Export Directory</h1>
						<p>Local directory where files will be exported to.</p>
						<p v-if="isEditExportPathConcerning" class="concern">Warning: Using an export path with spaces may lead to problems in most 3D programs.</p>
						<file-field v-model="configEdit.exportDirectory" :class="{ concern: isEditExportPathConcerning }"></file-field>
					</div>
					<div>
						<h1>Scroll Speed</h1>
						<p>How many lines at a time you scroll down in the results view (leave at 0 for default scroll amount)</p>
						<input type="number" v-model.number="configEdit.scrollSpeed"/>
					</div>
					<div>
						<h1>Display File Lists in Numerical Order (FileDataID)</h1>
						<p>If enabled, all file lists will be ordered numerically by file ID, otherwise alphabetically by filename.</p>
						<label class="ui-checkbox">
						<input type="checkbox" v-model="configEdit.listfileSortByID"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Find Unknown Files (Requires Restart)</h1>
						<p>If enabled, wow.export will use various methods to locate unknown files.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableUnknownFiles"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Load Model Skins (Requires Restart)</h1>
						<p>If enabled, wow.export will parse creature and item skins from data tables for M2 models.</p>
						<p>Disabling this will reduce memory usage and improve loading, but will disable M2 skin functionality.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableM2Skins"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Include Bone Prefixes</h1>
						<p>If enabled, wow.export will Include _p Bone prefixes in model skeleton/armature.</p>
						<p>Disabling this will break backwards compatibility with previous glTF model and animation exports.</p>
						<label class="ui-checkbox" title="">
							<input type="checkbox" v-model="configEdit.modelsExportWithBonePrefix"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Enable Shared Textures (Recommended)</h1>
						<p>If enabled, exported textures will be exported to their own path rather than with their parent.</p>
						<p>This dramatically reduces disk space used by not duplicating textures.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableSharedTextures"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Enable Shared Children (Recommended)</h1>
						<p>If enabled, exported models on a WMO/ADT will be exported to their own path rather than with their parent.</p>
						<p>This dramatically reduces disk space used by not duplicating models.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableSharedChildren"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Strip Whitespace From Export Paths</h1>
						<p>If enabled, whitespace will be removed from exported paths.</p>
						<p>Enable this option if your 3D software does not support whitespace in paths.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.removePathSpaces"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Strip Whitespace From Copied Paths</h1>
						<p>If enabled, file paths copied from a listbox (CTRL + C) will have whitespace stripped.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.removePathSpacesCopy"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Path Separator Format</h1>
						<p>Sets the path separator format used in exported files.</p>
						<ul class="ui-multi-button" id="export-meta-multi">
							<li :class="{ selected: configEdit.pathFormat == 'win32' }" @click.stop="configEdit.pathFormat = 'win32'">Windows</li>
							<li :class="{ selected: configEdit.pathFormat == 'posix' }" @click.stop="configEdit.pathFormat = 'posix'">POSIX</li>
						</ul>
					</div>
					<div>
						<h1>Use Absolute MTL Texture Paths</h1>
						<p>If enabled, MTL files will contain absolute textures paths rather than relative ones.</p>
						<p>This will cause issues when sharing exported models between computers.</p>
						<p>Enable this option if you are having issues importing OBJ models with Shared Textures enabled.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableAbsoluteMTLPaths"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Use Absolute glTF Texture Paths</h1>
						<p>If enabled, glTF files will contain absolute textures paths rather than relative ones.</p>
						<p>This will cause issues when sharing exported models between computers.</p>
						<p>Enable this option if you are having issues importing glTF models with Shared Textures enabled.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableAbsoluteGLTFPaths"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Use Absolute Model Placement Paths</h1>
						<p>If enabled, paths inside model placement files (CSV) will contain absolute paths rather than relative ones.</p>
						<p>This will cause issues when sharing exported models between computers.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableAbsoluteCSVPaths"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>CASC Locale</h1>
						<p>Which locale to use for file reading. This only affects game files.</p>
						<p>This should match the locale of your client when using local installations.</p>
						<menu-button class="spaced" :dropdown="true" :options="availableLocaleKeys" :default="selectedLocaleKey" @change="configEdit.cascLocale = availableLocale.flags[$event]"></menu-button>
					</div>
					<div>
						<h1>WebP Quality</h1>
						<p>Quality setting for WebP exports. Range is 1-100 (100 is lossless)</p>
						<input type="number" min="1" max="100" v-model.number="configEdit.exportWebPQuality"/>
					</div>
					<div>
						<h1>Export Model Collision</h1>
						<p>If enabled, M2 models exported as OBJ will also have their collision exported into a .phys.obj file.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.modelsExportCollision"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Export Additional UV Layers</h1>
						<p>If enabled, additional UV layers will be exported for M2/WMO models, included as non-standard properties (vt2, vt3, etc) in OBJ files.</p>
						<p>Use the wow.export Blender add-on to import OBJ models with additional UV layers.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.modelsExportUV2"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Export Meta Data</h1>
						<p>If enabled, verbose data will be exported for enabled formats into relative .json files.</p>
						<ul class="ui-multi-button" id="export-meta-multi">
							<li :class="{ selected: configEdit.exportM2Meta }" @click.stop="configEdit.exportM2Meta = !configEdit.exportM2Meta">M2</li>
							<li :class="{ selected: configEdit.exportWMOMeta }" @click.stop="configEdit.exportWMOMeta = !configEdit.exportWMOMeta">WMO</li>
							<li :class="{ selected: configEdit.exportBLPMeta }" @click.stop="configEdit.exportBLPMeta = !configEdit.exportBLPMeta">BLP</li>
							<li :class="{ selected: configEdit.exportFoliageMeta }" @click.stop="configEdit.exportFoliageMeta = !configEdit.exportFoliageMeta">Foliage</li>
						</ul>
					</div>
					<div>
						<h1>Export M2 Bone Data</h1>
						<p>If enabled, bone data will be exported in a relative _bones.json file.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.exportM2Bones"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Always Overwrite Existing Files (Recommended)</h1>
						<p>When exporting, files will always be written to disk even if they exist.</p>
						<p>Disabling this can speed up exporting, but may lead to issues between versions.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.overwriteFiles"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Name Exported Files</h1>
						<p>When enabled, files are exported using their listfile names (e.g., "ability_stealth.png").</p>
						<p>When disabled, files are exported using their fileDataID numbers (e.g., "12345.png").</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.exportNamedFiles"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Prevent 3D Preview Overwrites</h1>
						<p>If enabled, 3D preview exports will add increments to prevent overwriting existing files.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.modelsExportPngIncrements"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Regular Expression Filtering (Advanced)</h1>
						<p>Allows use of regular expressions in filtering lists.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.regexFilters"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Copy Mode</h1>
						<p>By default, using CTRL + C on a file list will copy the full entry to your clipboard.</p>
						<p>Setting this to Directory will instead only copy the directory of the given entry.</p>
						<p>Setting this to FileDataID will instead only copy the FID of the entry (must have FIDs enabled).</p>
						<ul class="ui-multi-button" id="export-copy-multi">
							<li :class="{ selected: configEdit.copyMode == 'FULL' }" @click.stop="configEdit.copyMode = 'FULL'">Full</li>
							<li :class="{ selected: configEdit.copyMode == 'DIR' }" @click.stop="configEdit.copyMode = 'DIR'">Directory</li>
							<li :class="{ selected: configEdit.copyMode == 'FID' }" @click.stop="configEdit.copyMode = 'FID'">FileDataID</li>
						</ul>
					</div>
					<div>
						<h1>Paste Selection</h1>
						<p>If enabled, using CTRL + V on the model list will attempt to select filenames you paste.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.pasteSelection"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Split Large Terrain Maps (Recommended)</h1>
						<p>If enabled, exporting baked terrain above 8k will be split into smaller files rather than one large file.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.splitLargeTerrainBakes"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Split Alpha Maps</h1>
						<p>If enabled, terrain alpha maps will be exported as individual images for each ADT chunk.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.splitAlphaMaps"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Show unknown items</h1>
						<p>When enabled, wow.export will list all items in the items tab, even those without a name.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.itemViewerShowAll"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Cache Expiry</h1>
						<p>After how many days of inactivity is cached data deleted. Setting to zero disables cache clean-up (not recommended).</p>
						<input type="number" v-model.number="configEdit.cacheExpiry"/>
					</div>
					<div>
						<h1>Manually Clear Cache (Requires Restart)</h1>
						<p>While housekeeping on the cache is mostly automatic, sometimes clearing manually can resolve issues.</p>
						<input type="button" class="spaced" :value="'Clear Cache (' + cacheSizeFormatted + ')'" @click="click('cache-clear', $event)" :class="{ disabled: isBusy }"/>
					</div>
					<div>
						<h1>Encryption Keys</h1>
						<p>Remote URL used to update keys for encrypted files.</p>
						<p>Primary <input type="text" class="long" v-model.trim="configEdit.tactKeysURL"/></p>
						<p>Fallback <input type="text" class="long" v-model.trim="configEdit.tactKeysFallbackURL"/></p>
					</div>
					<div>
						<h1>Add Encryption Key</h1>
						<p>Manually add a BLTE encryption key.</p>
						<input type="text" width="140" v-model.trim="userInputTactKeyName" maxlength="16" placeholder="e.g 8F4098E2470FE0C8"/>
						<input type="text" width="280" v-model.trim="userInputTactKey" maxlength="32" placeholder="e.g AA718D1F1A23078D49AD0C606A72F3D5"/>
						<input type="button" value="Add" @click="click('tact-key', $event)"/>
					</div>
					<div>
						<h1>Realm List Source</h1>
						<p>Remote URL used for retrieving the realm list. (Must use same format)</p>
						<p><input type="text" class="long" v-model.trim="configEdit.realmListURL"/></p>
					</div>
					<div>
						<h1>Character Appearance API Endpoint</h1>
						<p>Remote URL used for retrieving data from the Battle.net Character Appearance API. (Must use same format)</p>
						<p><input type="text" class="long" v-model.trim="configEdit.armoryURL"/></p>
					</div>
					<div>
						<h1>Use Binary Listfile Format (Requires Restart)</h1>
						<p>If enabled, wow.export will use the optimized binary listfile format instead of the legacy CSV format.</p>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="configEdit.enableBinaryListfile"/>
							<span>Enable</span>
						</label>
					</div>
					<div>
						<h1>Listfile Binary Source</h1>
						<p>Remote URL used for downloading the optimized binary listfile format. (Must use same format)</p>
						<p><input type="text" class="long" v-model.trim="configEdit.listfileBinarySource"/></p>
					</div>
					<div>
						<h1>Listfile Source (Legacy)</h1>
						<p>Remote URL or local path used for updating the CASC listfile. (Must use same format)</p>
						<p>Primary <input type="text" class="long" v-model.trim="configEdit.listfileURL"/></p>
						<p>Fallback <input type="text" class="long" v-model.trim="configEdit.listfileFallbackURL" /></p>
					</div>
					<div>
						<h1>Listfile Update Frequency</h1>
						<p>How often (in days) the listfile is updated. Set to zero to always re-download the listfile.</p>
						<input type="number" v-model.number="configEdit.listfileCacheRefresh"/>
					</div>
					<div>
						<h1>Data Table Definition Repository</h1>
						<p>Remote URL used to update DBD definitions. (Must use same format)</p>
						<p>Primary <input type="text" class="long" v-model.trim="configEdit.dbdURL"/></p>
						<p>Fallback <input type="text" class="long" v-model.trim="configEdit.dbdFallbackURL" /></p>
					</div>
					<div>
						<h1>DBD Manifest Repository</h1>
						<p>Remote URL used to obtain DBD manifest information. (Must use same format)</p>
						<p>Primary <input type="text" class="long" v-model.trim="configEdit.dbdFilenameURL"/></p>
						<p>Fallback <input type="text" class="long" v-model.trim="configEdit.dbdFilenameFallbackURL" /></p>
					</div>
					<div>
						<h1>Last Export File Location</h1>
						<p>Override the text file location which export manifest entries are written to.</p>
						<input type="text" v-model.trim="configEdit.lastExportFile" :placeholder="lastExportPathDefault" class="long"/>
					</div>
				</div>
				<div id="toast" v-if="toast" :class="toast.type">
					{{ toast.message }}
					<span v-for="(func, label) in toast.options" @click="handleToastOptionClick(func)">{{ label }}</span>
					<div class="close" v-if="toast.closable" @click="hideToast(true)"></div>
				</div>
				<div id="toast" v-if="!toast && screen === 'tab-models' && overrideModelList.length > 0" class="progress">
					Filtering models for item: {{ overrideModelName }}
					<span @click="removeOverrideModels">Remove</span>
					<div class="close" @click="removeOverrideModels"></div>
				</div>
				
				<!-- Home Tab -->
				<div class="tab" id="tab-home" v-if="screen === 'tab-home'">
					<div id="home-buttons" class="home-button-tray">
						<div @click="setScreen('tab-models')">
							<b>3D Models</b>
							<span>View and export 3D models to common formats.</span>
						</div>
						<div @click="setScreen('tab-characters')">
							<b>Characters</b>
							<span>Customize and export playable characters.</span>
						</div>
						<div @click="setScreen('tab-items')">
							<b>Items</b>
							<span>Browse in-game items and find associated models/textures.</span>
						</div>
						<div @click="setScreen('tab-textures')">
							<b>Textures</b>
							<span>View and export textures to common formats.</span>
						</div>
						<div @click="setScreen('tab-sounds')">
							<b>Audio</b>
							<span>Play and export in-game sound effects, music and dialog.</span>
						</div>
						<div @click="setScreen('tab-video')">
							<b>Videos</b>
							<span>Export pre-rendered cinematics.</span>
						</div>
						<div @click="setScreen('tab-maps')">
							<b>Maps</b>
							<span>Explore and export terrain with buildings, foliage, liquid and more.</span>
						</div>
						<div @click="setScreen('tab-zones')">
							<b>Zones</b>
							<span>Search and export in-game maps for all available zones.</span>
						</div>
						<div @click="setScreen('tab-text')">
							<b>Text</b>
							<span>Inspect text tables, scripts, XML and more.</span>
						</div>
						<div @click="setScreen('tab-data')">
							<b>Data</b>
							<span>Search and export records across all known data tables.</span>
						</div>
					</div>
					<div id="home-changes">
						<div v-html="whatsNewHTML"></div>
					</div>
					<div id="home-help-buttons">
						<div data-external="::DISCORD">
							<b>Stuck? Need Help?</b>
							<span>Join our Discord community for support!</span>
						</div>
						<div data-external="::GITHUB">
							<b>Gnomish Heritage?</b>
							<span>wow.export is open-source, tinkerers are welcome!</span>
						</div>
						<div data-external="::PATREON">
							<b>Support Us!</b>
							<span>Support development of wow.export through Patreon!</span>
						</div>
					</div>
				</div>

				<div class="tab" id="legacy-tab-home" v-if="screen === 'legacy-tab-home'">
					<div id="home-buttons" class="home-button-tray">
						<div @click="setScreen('legacy-tab-models')">
							<b>Models</b>
							<span>View and export 3D models from MPQ archives.</span>
						</div>
						<div @click="setScreen('legacy-tab-textures')">
							<b>Textures</b>
							<span>View and export textures to common formats.</span>
						</div>
						<div @click="setScreen('legacy-tab-sounds')">
							<b>Sounds</b>
							<span>Play and export audio files from MPQ archives.</span>
						</div>
						<div @click="setScreen('legacy-tab-files')">
							<b>Files</b>
							<span>Browse and export all raw files from MPQ archives.</span>
						</div>
					</div>
					<div id="home-changes">
						<div v-html="whatsNewHTML"></div>
					</div>
					<div id="home-help-buttons">
						<div data-external="::DISCORD">
							<b>Stuck? Need Help?</b>
							<span>Join our Discord community for support!</span>
						</div>
						<div data-external="::GITHUB">
							<b>Gnomish Heritage?</b>
							<span>wow.export is open-source, tinkerers are welcome!</span>
						</div>
						<div data-external="::PATREON">
							<b>Support Us!</b>
							<span>Support development of wow.export through Patreon!</span>
						</div>
					</div>
				</div>
				
				<div id="toast" v-if="!toast && screen === 'tab-textures' && overrideTextureList.length > 0" class="progress">
					Filtering textures for item: {{ overrideTextureName }}
					<span @click="removeOverrideTextures">Remove</span>
					<div class="close" @click="removeOverrideTextures"></div>
				</div>
				<div class="tab list-tab" id="tab-textures" v-if="screen === 'tab-textures'">
					<div class="list-container">
						<listbox v-model:selection="selectionTextures" :items="listfileTextures" :override="overrideTextureList" :filter="userInputFilterTextures" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="texture" persistscrollkey="textures"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterTextures" placeholder="Filter textures..."/>
					</div>
					<div class="preview-container">
						<div class="preview-info" v-if="config.showTextureInfo && texturePreviewInfo.length > 0">{{ texturePreviewInfo }}</div>
						<ul class="preview-channels" v-if="texturePreviewURL.length > 0">
							<li id="channel-red" :class="{ selected: (config.exportChannelMask & 0b1) }" @click.self="config.exportChannelMask ^= 0b1" title="Toggle red colour channel.">R</li>
							<li id="channel-green" :class="{ selected: (config.exportChannelMask & 0b10) }" @click.self="config.exportChannelMask ^= 0b10" title="Toggle green colour channel.">G</li>
							<li id="channel-blue" :class="{ selected: (config.exportChannelMask & 0b100) }" @click.self="config.exportChannelMask ^= 0b100" title="Toggle blue colour channel.">B</li>
							<li id="channel-alpha" :class="{ selected: (config.exportChannelMask & 0b1000) }" @click.self="config.exportChannelMask ^= 0b1000" title="Toggle alpha channel.">A</li>
						</ul>
						<div class="preview-background" id="texture-preview" :style="{ 'max-width': texturePreviewWidth + 'px', 'max-height': texturePreviewHeight + 'px' }">
							<div id="atlas-overlay" v-if="config.showTextureAtlas">
								<div class="atlas-region" v-for="region of textureAtlasOverlayRegions" :style="{ left: region.left, top: region.top, width: region.width, height: region.height }">
									<span>{{ region.name }}</span>
								</div>
							</div>
							<div class="image" :style="{ 'background-image': 'url(' + texturePreviewURL + ')' }"></div>
						</div>
					</div>
					<div class="preview-controls">
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.showTextureAtlas"/>
							<span>Show Atlas Regions</span>
						</label>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.showTextureInfo"/>
							<span>Show Info</span>
						</label>
						<label class="ui-checkbox">
							<input type="checkbox" :checked="(config.exportChannelMask & 0b1000)" @change="$event.target.checked ? config.exportChannelMask |= 0b1000 : config.exportChannelMask &= 0b0111"/>
							<span>Transparency</span>
						</label>
						<input v-if="isBakedNPCTexture()" type="button" value="Apply to Character" @click="click('apply-baked-npc-texture', $event)" :class="{ disabled: isBusy }" style="margin-right: 5px"/>
						<input v-if="config.showTextureAtlas" type="button" value="Export Atlas Regions" @click="click('export-texture-atlas-region', $event)" :class="{ disabled: isBusy }" style="margin-right: 5px"/>
						<menu-button :options="menuButtonTextures" :default="config.exportTextureFormat" @change="config.exportTextureFormat = $event" :disabled="isBusy" @click="click('export-texture', $event)"></menu-button>
					</div>
				</div>

				<div class="tab list-tab" id="legacy-tab-textures" v-if="screen === 'legacy-tab-textures'">
					<div class="list-container">
						<listbox v-model:selection="selectionTextures" :items="listfileTextures" :filter="userInputFilterTextures" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="texture" persistscrollkey="textures"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterTextures" placeholder="Filter textures..."/>
					</div>
					<div class="preview-container">
						<div class="preview-info" v-if="config.showTextureInfo && texturePreviewInfo.length > 0">{{ texturePreviewInfo }}</div>
						<ul class="preview-channels" v-if="texturePreviewURL.length > 0">
							<li id="channel-red" :class="{ selected: (config.exportChannelMask & 0b1) }" @click.self="config.exportChannelMask ^= 0b1" title="Toggle red colour channel.">R</li>
							<li id="channel-green" :class="{ selected: (config.exportChannelMask & 0b10) }" @click.self="config.exportChannelMask ^= 0b10" title="Toggle green colour channel.">G</li>
							<li id="channel-blue" :class="{ selected: (config.exportChannelMask & 0b100) }" @click.self="config.exportChannelMask ^= 0b100" title="Toggle blue colour channel.">B</li>
							<li id="channel-alpha" :class="{ selected: (config.exportChannelMask & 0b1000) }" @click.self="config.exportChannelMask ^= 0b1000" title="Toggle alpha channel.">A</li>
						</ul>
						<div class="preview-background" id="texture-preview" :style="{ 'max-width': texturePreviewWidth + 'px', 'max-height': texturePreviewHeight + 'px' }">
							<div class="image" :style="{ 'background-image': 'url(' + texturePreviewURL + ')' }"></div>
						</div>
					</div>
					<div class="preview-controls">
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.showTextureInfo"/>
							<span>Show Info</span>
						</label>
						<label class="ui-checkbox">
							<input type="checkbox" :checked="(config.exportChannelMask & 0b1000)" @change="$event.target.checked ? config.exportChannelMask |= 0b1000 : config.exportChannelMask &= 0b0111"/>
							<span>Transparency</span>
						</label>
						<menu-button :options="menuButtonTextures" :default="config.exportTextureFormat" @change="config.exportTextureFormat = $event" :disabled="isBusy" @click="click('export-legacy-texture', $event)"></menu-button>
					</div>
				</div>

				<div class="tab list-tab" id="legacy-tab-models" v-if="screen === 'legacy-tab-models'">
					<div class="list-container">
						<listbox v-model:selection="selectionLegacyModels" :items="listfileLegacyModels" :filter="userInputFilterLegacyModels" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="model" persistscrollkey="legacy_models"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterLegacyModels" placeholder="Filter models..."/>
					</div>
					<div class="preview-container">
						<resize-layer @resize="onTextureRibbonResize" id="texture-ribbon" v-if="config.modelViewerShowTextures && textureRibbonStack.length > 0">
							<div id="texture-ribbon-prev" v-if="textureRibbonPage > 0" @click.self="textureRibbonPage--"></div>
							<div v-for="slot in textureRibbonDisplay" :title="slot.displayName" :style="{ backgroundImage: 'url(' + slot.src + ')' }" class="slot" @click="contextMenus.nodeTextureRibbon = slot"></div>
							<div id="texture-ribbon-next" v-if="textureRibbonPage < textureRibbonMaxPages - 1" @click.self="textureRibbonPage++"></div>
							<context-menu :node="contextMenus.nodeTextureRibbon" v-slot:default="context" @close="contextMenus.nodeTextureRibbon = null">
								<span @click.self="click('preview-legacy-texture', $event, context.node)">Preview {{ context.node.displayName }}</span>
								<span @click.self="click('export-legacy-ribbon-texture', $event, context.node)">Export {{ context.node.displayName }}</span>
								<span @click.self="copyToClipboard(context.node.displayName)">Copy texture name to clipboard</span>
								<span @click.self="copyToClipboard(context.node.fileName)">Copy file path to clipboard</span>
							</context-menu>
						</resize-layer>
						<div id="model-texture-preview" v-if="legacyModelTexturePreviewURL.length > 0" class="preview-background">
							<div id="model-texture-preview-toast" @click="legacyModelTexturePreviewURL = ''">Close Preview</div>
							<div class="image" :style="{ 'max-width': legacyModelTexturePreviewWidth + 'px', 'max-height': legacyModelTexturePreviewHeight + 'px' }">
								<div class="image" :style="{ 'background-image': 'url(' + legacyModelTexturePreviewURL + ')' }"></div>
								<div class="uv-overlay" v-if="legacyModelTexturePreviewUVOverlay" :style="{ 'background-image': 'url(' + legacyModelTexturePreviewUVOverlay + ')' }"></div>
							</div>
							<div id="uv-layer-buttons" v-if="legacyModelViewerUVLayers.length > 0">
								<button
									v-for="layer in legacyModelViewerUVLayers"
									:key="layer.name"
									:class="{ active: layer.active }"
									@click="toggleLegacyUVLayer(layer.name)"
									class="uv-layer-button"
								>
									{{ layer.name }}
								</button>
							</div>
						</div>
						<div class="preview-background" id="model-preview">
							<input v-if="config.modelViewerShowBackground" type="color" id="background-color-input" v-model="config.modelViewerBackgroundColor" title="Click to change background color"/>
							<model-viewer :context="legacyModelViewerContext"></model-viewer>
							<div v-if="legacyModelViewerAnims && legacyModelViewerAnims.length > 0 && !legacyModelTexturePreviewURL" class="animation-dropdown-overlay">
								<select class="animation-dropdown" v-model="legacyModelViewerAnimSelection">
									<option v-for="animation in legacyModelViewerAnims" :key="animation.id" :value="animation.id">
										{{ animation.label }}
									</option>
								</select>
							</div>
						</div>
					</div>
					<div class="preview-controls">
						<menu-button :options="menuButtonModels" :default="config.exportModelFormat" @change="config.exportModelFormat = $event" class="upward" :disabled="isBusy" @click="click('export-legacy-model', $event)"></menu-button>
					</div>
					<div id="model-sidebar" class="sidebar">
						<span class="header">Preview</span>
						<label class="ui-checkbox" title="Automatically preview a model when selecting it">
							<input type="checkbox" v-model="config.modelsAutoPreview"/>
							<span>Auto Preview</span>
						</label>
						<label class="ui-checkbox" title="Automatically adjust camera when selecting a new model">
							<input type="checkbox" v-model="legacyModelViewerAutoAdjust"/>
							<span>Auto Camera</span>
						</label>
						<label class="ui-checkbox" title="Show a grid in the 3D viewport">
							<input type="checkbox" v-model="config.modelViewerShowGrid"/>
							<span>Show Grid</span>
						</label>
						<label class="ui-checkbox" title="Render the preview model as a wireframe">
							<input type="checkbox" v-model="config.modelViewerWireframe"/>
							<span>Show Wireframe</span>
						</label>
						<label class="ui-checkbox" title="Show the model's bone structure">
							<input type="checkbox" v-model="config.modelViewerShowBones"/>
							<span>Show Bones</span>
						</label>
						<label class="ui-checkbox" title="Show model textures in the preview pane">
							<input type="checkbox" v-model="config.modelViewerShowTextures"/>
							<span>Show Textures</span>
						</label>
						<label class="ui-checkbox" title="Show a background color in the 3D viewport">
							<input type="checkbox" v-model="config.modelViewerShowBackground"/>
							<span>Show Background</span>
						</label>
						<span class="header">Export</span>
						<label class="ui-checkbox" title="Include textures when exporting models">
							<input type="checkbox" v-model="config.modelsExportTextures"/>
							<span>Textures</span>
						</label>
						<label v-if="config.modelsExportTextures" class="ui-checkbox" title="Include alpha channel in exported model textures">
							<input type="checkbox" v-model="config.modelsExportAlpha"/>
							<span>Texture Alpha</span>
						</label>
						<label v-if="config.exportModelFormat === 'GLTF' && legacyModelViewerActiveType === 'm2'" class="ui-checkbox" title="Include animations in export">
							<input type="checkbox" v-model="config.modelsExportAnimations"/>
							<span>Export animations</span>
						</label>
						<template v-if="config.exportModelFormat === 'RAW'">
							<label class="ui-checkbox" title="Export raw .skin files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportSkin"/>
								<span>M2 .skin Files</span>
							</label>
							<label class="ui-checkbox" title="Export raw .skel files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportSkel"/>
								<span>M2 .skel Files</span>
							</label>
							<label class="ui-checkbox" title="Export raw .bone files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportBone"/>
								<span>M2 .bone Files</span>
							</label>
							<label class="ui-checkbox" title="Export raw .anim files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportAnim"/>
								<span>M2 .anim files</span>
							</label>
							<label class="ui-checkbox" title="Export WMO group files">
								<input type="checkbox" v-model="config.modelsExportWMOGroups"/>
								<span>WMO Groups</span>
							</label>
						</template>
						<template v-if="config.exportModelFormat === 'OBJ' && legacyModelViewerActiveType === 'wmo'">
							<label class="ui-checkbox" title="Export each WMO group as a separate OBJ file">
								<input type="checkbox" v-model="config.modelsExportSplitWMOGroups"/>
								<span>Split WMO Groups</span>
							</label>
						</template>
						<template v-if="legacyModelViewerActiveType === 'm2'">
							<span class="header">Geosets</span>
							<checkboxlist :items="legacyModelViewerGeosets"></checkboxlist>
							<div class="list-toggles">
								<a @click="setAllGeosets(true, legacyModelViewerGeosets)">Enable All</a> / <a @click="setAllGeosets(false, legacyModelViewerGeosets)">Disable All</a>
							</div>
							<template v-if="config.modelsExportTextures && legacyModelViewerSkins.length > 0">
								<span class="header">Skins</span>
								<listboxb :items="legacyModelViewerSkins" v-model:selection="legacyModelViewerSkinsSelection" :single="true"></listboxb>
							</template>
						</template>
						<template v-if="legacyModelViewerActiveType === 'wmo'">
							<span class="header">WMO Groups</span>
							<checkboxlist :items="legacyModelViewerWMOGroups"></checkboxlist>
							<div class="list-toggles">
								<a @click="setAllLegacyWMOGroups(true)">Enable All</a> / <a @click="setAllLegacyWMOGroups(false)">Disable All</a>
							</div>
							<span class="header">Doodad Sets</span>
							<checkboxlist :items="legacyModelViewerWMOSets"></checkboxlist>
						</template>
					</div>
				</div>

				<div class="tab list-tab" id="legacy-tab-sounds" v-if="screen === 'legacy-tab-sounds'">
					<div class="list-container">
						<listbox v-model:selection="selectionSounds" :items="listfileSounds" :filter="userInputFilterSounds" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="sound file" persistscrollkey="sounds"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterSounds" placeholder="Filter sound files..."/>
					</div>
					<div id="sound-player">
						<div id="sound-player-anim" :style="{ 'animation-play-state': soundPlayerState ? 'running' : 'paused' }"></div>
						<div id="sound-player-controls">
							<div id="sound-player-info">
								<span>{{ soundPlayerSeekFormatted }}</span>
								<span class="title">{{ soundPlayerTitle }}</span>
								<span>{{ soundPlayerDurationFormatted }}</span>
							</div>
							<slider id="slider-seek" v-model="soundPlayerSeek" @update:model-value="emit('click-sound-seek', $event)"></slider>
							<div class="buttons">
								<input type="button" :class="{ isPlaying: !soundPlayerState }" @click="click('sound-toggle', $event)"/>
								<slider id="slider-volume" v-model="config.soundPlayerVolume"></slider>
							</div>
						</div>
					</div>
					<div class="preview-controls">
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.soundPlayerLoop"/>
							<span>Loop</span>
						</label>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.soundPlayerAutoPlay"/>
							<span>Autoplay</span>
						</label>
						<input type="button" value="Export Selected" @click="click('export-legacy-sound', $event)" :class="{ disabled: isBusy }"/>
					</div>
				</div>

				<div class="tab list-tab" id="legacy-tab-files" v-if="screen === 'legacy-tab-files'">
					<div class="list-container">
						<listbox v-model:selection="selectionRaw" :items="listfileRaw" :filter="userInputFilterRaw" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="file" persistscrollkey="legacy-files"></listbox>
					</div>
					<div id="tab-legacy-files-tray">
						<div class="filter">
							<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
							<input type="text" v-model="userInputFilterRaw" placeholder="Filter files..."/>
						</div>
						<input type="button" value="Export Selected" @click="click('export-legacy-file', $event)" :class="{ disabled: isBusy || selectionRaw.length === 0 }"/>
					</div>
				</div>

				<div class="tab list-tab" id="tab-maps" v-if="screen === 'tab-maps'">
					<div class="map-placeholder">
						<div class="expansion-buttons">
							<button class="expansion-button show-all"
									title="Show All"
									:class="{ active: selectedExpansionFilter === -1 }"
									@click="selectedExpansionFilter = -1">
							</button>
							<button v-for="expansion in constants.EXPANSIONS" 
									:key="expansion.id"
									class="expansion-button"
									:title="expansion.name"
									:class="{ active: selectedExpansionFilter === expansion.id }"
									@click="selectedExpansionFilter = expansion.id"
									:style="'background-image: var(--expansion-icon-' + expansion.id + ')'">
							</button>
						</div>
					</div>
					<div class="list-container" id="maps-list-container">
						<listbox-maps id="listbox-maps" class="listbox-icons" v-model:selection="selectionMaps" :items="mapViewerMaps" :filter="userInputFilterMaps" :expansion-filter="selectedExpansionFilter" :keyinput="true" :single="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="map" persistscrollkey="maps"></listbox-maps>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterMaps" placeholder="Filter maps..."/>
					</div>
					<map-viewer :map="mapViewerSelectedMap" :loader="mapViewerTileLoader" :tile-size="512" :zoom="12" :mask="mapViewerChunkMask" v-model:selection="mapViewerSelection"></map-viewer>
					<div class="spaced-preview-controls">
						<input type="button" value="Export Global WMO" @click="click('export-map-wmo', $event)" :class="{ disabled: isBusy || !mapViewerHasWorldModel }"/>
						<menu-button :options="menuButtonMapExport" :default="config.exportMapFormat" @change="config.exportMapFormat = $event" :disabled="isBusy || mapViewerSelection.length === 0" @click="click('export-map', $event)"></menu-button>
					</div>

					<div id="maps-sidebar" class="sidebar">
						<span class="header">Export Options</span>
						<label class="ui-checkbox" title="Include WMO objects (large objects such as buildings)">
							<input type="checkbox" v-model="config.mapsIncludeWMO"/>
							<span>Export WMO</span>
						</label>
						<label class="ui-checkbox" v-if="config.mapsIncludeWMO" title="Include objects inside WMOs (interior decorations)">
							<input type="checkbox" v-model="config.mapsIncludeWMOSets"/>
							<span>Export WMO Sets</span>
						</label>
						<label class="ui-checkbox" title="Export M2 objects on this tile (smaller objects such as trees)">
							<input type="checkbox" v-model="config.mapsIncludeM2"/>
							<span>Export M2</span>
						</label>
						<label class="ui-checkbox" title="Export foliage used on this tile (grass, etc)">
							<input type="checkbox" v-model="config.mapsIncludeFoliage"/>
							<span>Export Foliage</span>
						</label>
						<label v-if="!config.mapsExportRaw" class="ui-checkbox" title="Export raw liquid data (water, lava, etc)">
							<input type="checkbox" v-model="config.mapsIncludeLiquid"/>
							<span>Export Liquids</span>
						</label>
						<label class="ui-checkbox" title="Export client-side interactable objects (signs, banners, etc)">
							<input type="checkbox" v-model="config.mapsIncludeGameObjects"/>
							<span>Export G-Objects</span>
						</label>
						<label v-if="!config.mapsExportRaw" class="ui-checkbox" title="Include terrain holes for WMOs">
							<input type="checkbox" v-model="config.mapsIncludeHoles"/>
							<span>Include Holes</span>
						</label>
						<span class="header">Model Textures</span>
						<label class="ui-checkbox" title="Include textures when exporting models">
							<input type="checkbox" v-model="config.modelsExportTextures"/>
							<span>Textures</span>
						</label>
						<label v-if="config.modelsExportTextures" class="ui-checkbox" title="Include alpha channel in exported model textures">
							<input type="checkbox" v-model="config.modelsExportAlpha"/>
							<span>Texture Alpha</span>
						</label>
						<template v-if="!config.mapsExportRaw">
							<span class="header">Terrain Texture Quality</span>
							<menu-button :options="menuButtonTextureQuality" :default="config.exportMapQuality" @change="config.exportMapQuality = $event" :disabled="isBusy" :dropdown="true"></menu-button>
							<span class="header">Heightmaps</span>
							<menu-button :options="menuButtonHeightmapResolution" :default="config.heightmapResolution" @change="config.heightmapResolution = $event" :disabled="isBusy" :dropdown="true"></menu-button>
							<menu-button :options="menuButtonHeightmapBitDepth" :default="config.heightmapBitDepth" @change="config.heightmapBitDepth = $event" :disabled="isBusy" :dropdown="true" style="margin-top: 5px"></menu-button>
							<template v-if="config.heightmapResolution === -1">
								<span class="header" style="margin-top: 10px">Heightmap Resolution</span>
								<input type="number" v-model.number="config.heightmapCustomResolution" :disabled="isBusy" min="1" step="1" style="width: 100%; margin: unset; margin-top: 5px; padding: 10px; box-sizing: border-box;">
							</template>
						</template>
					</div>
				</div>
				<div class="tab list-tab" id="tab-zones" v-if="screen === 'tab-zones'">
					<div class="zone-placeholder">
						<div class="expansion-buttons">
							<button class="expansion-button show-all"
									title="Show All"
									:class="{ active: selectedZoneExpansionFilter === -1 }"
									@click="selectedZoneExpansionFilter = -1">
							</button>
							<button v-for="expansion in constants.EXPANSIONS" 
									:key="expansion.id"
									class="expansion-button"
									:title="expansion.name"
									:class="{ active: selectedZoneExpansionFilter === expansion.id }"
									@click="selectedZoneExpansionFilter = expansion.id"
									:style="'background-image: var(--expansion-icon-' + expansion.id + ')'">
							</button>
						</div>
					</div>
					<div class="list-container">
						<listbox-zones id="listbox-zones" class="listbox-icons" v-model:selection="selectionZones" :items="zoneViewerZones" :filter="userInputFilterZones" :expansion-filter="selectedZoneExpansionFilter" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="zone" persistscrollkey="zones"></listbox-zones>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterZones" placeholder="Filter zones..."/>
					</div>
					<div class="zone-export-controls">
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.showZoneOverlays"/>
							<span>Show Overlays</span>
						</label>
						<input type="button" value="Export Map" @click="click('export-zone', $event)" :class="{ disabled: isBusy || !selectionZones || selectionZones.length === 0 }"/>
					</div>
					<div class="zone-viewer-container preview-container">
						<div class="preview-background">
							<canvas id="zone-canvas"></canvas>
						</div>
					</div>
				</div>
				<div class="tab" id="tab-items" v-if="screen === 'tab-items'">
					<div class="list-container">
						<itemlistbox id="listbox-items" v-model:selection="selectionItems" :items="listfileItems" :filter="userInputFilterItems" :keyinput="true" :includefilecount="true" unittype="item" @options="contextMenus.nodeItem = $event"></itemlistbox>
						<context-menu :node="contextMenus.nodeItem" v-slot:default="context" @close="contextMenus.nodeItem = null">
							<span v-if="context.node.modelCount > 0" @click.self="viewModels(context.node)">View related models ({{ context.node.modelCount }})</span>
							<span v-if="context.node.textureCount > 0" @click.self="viewTextures(context.node)">View related textures ({{ context.node.textureCount }})</span>
							<span @click.self="copyToClipboard(context.node.name)">Copy item name to clipboard</span>
							<span @click.self="copyToClipboard(context.node.id)">Copy item ID to clipboard</span>
							<span @click.self="getExternalLink().wowHead_viewItem(context.node.id)">View item on Wowhead (web)</span>
						</context-menu>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterItems" placeholder="Filter items..."/>
					</div>
					<div id="items-sidebar" class="sidebar">
						<span class="header">Item Types</span>
						<checkboxlist :items="itemViewerTypeMask"></checkboxlist>
						<div class="list-toggles">
							<a @click="setAllItemTypes(true)">Enable All</a> / <a @click="setAllItemTypes(false)">Disable All</a>
						</div>
					</div>
				</div>
				<div class="tab list-tab" id="tab-models" v-if="screen === 'tab-models'">
					<div class="list-container">
						<listbox v-model:selection="selectionModels" :items="listfileModels" :override="overrideModelList" :filter="userInputFilterModels" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="model" persistscrollkey="models"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterModels" placeholder="Filter models..."/>
					</div>
					<div class="preview-container">
						<resize-layer @resize="onTextureRibbonResize" id="texture-ribbon" v-if="config.modelViewerShowTextures && textureRibbonStack.length > 0">
							<div id="texture-ribbon-prev" v-if="textureRibbonPage > 0" @click.self="textureRibbonPage--"></div>
							<div v-for="slot in textureRibbonDisplay" :title="slot.displayName" :style="{ backgroundImage: 'url(' + slot.src + ')' }" class="slot" @click="contextMenus.nodeTextureRibbon = slot"></div>
							<div id="texture-ribbon-next" v-if="textureRibbonPage < textureRibbonMaxPages - 1" @click.self="textureRibbonPage++"></div>
							<context-menu :node="contextMenus.nodeTextureRibbon" v-slot:default="context" @close="contextMenus.nodeTextureRibbon = null">
								<span @click.self="click('preview-texture', $event, context.node.fileDataID, context.node.displayName)">Preview {{ context.node.displayName }}</span>
								<span @click.self="click('export-ribbon-texture', $event, context.node.fileDataID, context.node.displayName)">Export {{ context.node.displayName }}</span>
								<span @click.self="goToTexture(context.node.fileDataID)">Go to {{ context.node.displayName }}</span>
								<span @click.self="copyToClipboard(context.node.fileDataID)">Copy file data ID to clipboard</span>
								<span @click.self="copyToClipboard(context.node.displayName)">Copy texture name to clipboard</span>
								<span @click.self="copyToClipboard(context.node.fileName)">Copy file path to clipboard</span>
								<span @click.self="copyToClipboard(getExportPath(context.node.fileName))">Copy export path to clipboard</span>
							</context-menu>
						</resize-layer>
						<div id="model-texture-preview" v-if="modelTexturePreviewURL.length > 0" class="preview-background">
							<div id="model-texture-preview-toast" @click="modelTexturePreviewURL = ''">Close Preview</div>
							<div class="image" :style="{ 'max-width': modelTexturePreviewWidth + 'px', 'max-height': modelTexturePreviewHeight + 'px' }">
								<div class="image" :style="{ 'background-image': 'url(' + modelTexturePreviewURL + ')' }"></div>
								<div class="uv-overlay" v-if="modelTexturePreviewUVOverlay" :style="{ 'background-image': 'url(' + modelTexturePreviewUVOverlay + ')' }"></div>
							</div>
							<div id="uv-layer-buttons" v-if="modelViewerUVLayers.length > 0">
								<button 
									v-for="layer in modelViewerUVLayers" 
									:key="layer.name"
									:class="{ active: layer.active }"
									@click="toggleUVLayer(layer.name)"
									class="uv-layer-button"
								>
									{{ layer.name }}
								</button>
							</div>
						</div>
						<div class="preview-background" id="model-preview">
							<input v-if="config.modelViewerShowBackground" type="color" id="background-color-input" v-model="config.modelViewerBackgroundColor" title="Click to change background color"/>
							<model-viewer :context="modelViewerContext"></model-viewer>
							<div v-if="modelViewerAnims && modelViewerAnims.length > 0 && !modelTexturePreviewURL" class="animation-dropdown-overlay">
								<select class="animation-dropdown" v-model="modelViewerAnimSelection">
									<option v-for="animation in modelViewerAnims" :key="animation.id" :value="animation.id">
										{{ animation.label }}
									</option>
								</select>
							</div>
						</div>
					</div>
					<div class="preview-controls">
						<menu-button :options="menuButtonModels" :default="config.exportModelFormat" @change="config.exportModelFormat = $event" class="upward" :disabled="isBusy" @click="click('export-model', $event)"></menu-button>
					</div>
					<div id="model-sidebar" class="sidebar">
						<span class="header">Preview</span>
						<label class="ui-checkbox" title="Automatically preview a model when selecting it">
							<input type="checkbox" v-model="config.modelsAutoPreview"/>
							<span>Auto Preview</span>
						</label>
						<label class="ui-checkbox" title="Automatically adjust camera when selecting a new model">
							<input type="checkbox" v-model="modelViewerAutoAdjust"/>
							<span>Auto Camera</span>
						</label>
						<label class="ui-checkbox" title="Show a grid in the 3D viewport">
							<input type="checkbox" v-model="config.modelViewerShowGrid"/>
							<span>Show Grid</span>
						</label>
						<label class="ui-checkbox" title="Render the preview model as a wireframe">
							<input type="checkbox" v-model="config.modelViewerWireframe"/>
							<span>Show Wireframe</span>
						</label>
						<label class="ui-checkbox" title="Show the model's bone structure">
							<input type="checkbox" v-model="config.modelViewerShowBones"/>
							<span>Show Bones</span>
						</label>
						<label class="ui-checkbox" title="Show model textures in the preview pane">
							<input type="checkbox" v-model="config.modelViewerShowTextures"/>
							<span>Show Textures</span>
						</label>
						<label class="ui-checkbox" title="Show a background color in the 3D viewport">
							<input type="checkbox" v-model="config.modelViewerShowBackground"/>
							<span>Show Background</span>
						</label>
						<span class="header">Export</span>
						<label class="ui-checkbox" title="Include textures when exporting models">
							<input type="checkbox" v-model="config.modelsExportTextures"/>
							<span>Textures</span>
						</label>
						<label v-if="config.modelsExportTextures" class="ui-checkbox" title="Include alpha channel in exported model textures">
							<input type="checkbox" v-model="config.modelsExportAlpha"/>
							<span>Texture Alpha</span>
						</label>
						<label v-if="config.exportModelFormat === 'GLTF' && modelViewerActiveType === 'm2'" class="ui-checkbox" title="Include animations in export">
							<input type="checkbox" v-model="config.modelsExportAnimations"/>
							<span>Export animations</span>
						</label>
						<template v-if="config.exportModelFormat === 'RAW'">
							<label class="ui-checkbox" title="Export raw .skin files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportSkin"/>
								<span>M2 .skin Files</span>
							</label>
							<label class="ui-checkbox" title="Export raw .skel files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportSkel"/>
								<span>M2 .skel Files</span>
							</label>
							<label class="ui-checkbox" title="Export raw .bone files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportBone"/>
								<span>M2 .bone Files</span>
							</label>
							<label class="ui-checkbox" title="Export raw .anim files with M2 exports">
								<input type="checkbox" v-model="config.modelsExportAnim"/>
								<span>M2 .anim files</span>
							</label>
							<label class="ui-checkbox" title="Export WMO group files">
								<input type="checkbox" v-model="config.modelsExportWMOGroups"/>
								<span>WMO Groups</span>
							</label>
						</template>
						<template v-if="config.exportModelFormat === 'OBJ' && modelViewerActiveType === 'wmo'">
							<label class="ui-checkbox" title="Export each WMO group as a separate OBJ file">
								<input type="checkbox" v-model="config.modelsExportSplitWMOGroups"/>
								<span>Split WMO Groups</span>
							</label>
						</template>
						<template v-if="modelViewerActiveType === 'm2'">
							<span class="header">Geosets</span>
							<checkboxlist :items="modelViewerGeosets"></checkboxlist>
							<div class="list-toggles">
								<a @click="setAllGeosets(true, modelViewerGeosets)">Enable All</a> / <a @click="setAllGeosets(false, modelViewerGeosets)">Disable All</a>
							</div>
							<template v-if="config.modelsExportTextures">
								<span class="header">Skins</span>
								<listboxb :items="modelViewerSkins" v-model:selection="modelViewerSkinsSelection" :single="true"></listboxb>
							</template>
						</template>
						<template v-if="modelViewerActiveType === 'wmo'">
							<span class="header">WMO Groups</span>
							<checkboxlist :items="modelViewerWMOGroups"></checkboxlist>
							<div class="list-toggles">
								<a @click="setAllWMOGroups(true)">Enable All</a> / <a @click="setAllWMOGroups(false)">Disable All</a>
							</div>
							<span class="header">Doodad Sets</span>
							<checkboxlist :items="modelViewerWMOSets"></checkboxlist>
						</template>
					</div>
				</div>
				<div class="tab" id="tab-characters" v-if="screen === 'tab-characters'">
					<div v-if="chrModelViewerAnims && chrModelViewerAnims.length > 0" class="animation-dropdown-overlay">
						<select class="animation-dropdown" v-model="chrModelViewerAnimSelection">
							<option v-for="animation in chrModelViewerAnims" :key="animation.id" :value="animation.id">
								{{ animation.label }}
							</option>
						</select>
					</div>
					<div class="character-import-buttons">
						<input type="button" value="Battle.net" class="ui-image-button character-bnet-button" @click="characterImportMode = characterImportMode === 'BNET' ? 'none' : 'BNET'" :class="{ active: characterImportMode === 'BNET' }"/>
						<input type="button" value="Wowhead" class="ui-image-button character-wowhead-button" @click="characterImportMode = characterImportMode === 'WHEAD' ? 'none' : 'WHEAD'" :class="{ active: characterImportMode === 'WHEAD' }"/>
						<input type="button" value="WoW Model Viewer" class="ui-image-button character-wmv-button" @click="click('import-wmv', $event)"/>
					</div>
					<div v-if="characterImportMode === 'BNET'" id="character-import-panel-floating" @click.stop>
						<div class="header"><b>Character Import</b></div>
						<ul class="ui-multi-button">
							<li v-for="region of chrImportRegions" :class="{ selected: chrImportSelectedRegion === region }" @click.stop="chrImportSelectedRegion = region">{{ region.toUpperCase() }}</li>
						</ul>
						<input type="text" v-model="chrImportChrName" placeholder="Character Name"/>
						<combo-box v-model:value="chrImportSelectedRealm" :source="chrImportRealms" placeholder="Character Realm" maxheight="10"></combo-box>
						<label class="ui-checkbox" title="Load visage model (Dracthyr/Worgen)">
							<input type="checkbox" v-model="chrImportLoadVisage"/>
							<span>Load visage model (Dracthyr/Worgen)</span>
						</label>
						<input type="button" value="Import Character" @click="click('import-character', $event)" :class="{ disabled: isBusy }"/>
					</div>
					<div v-if="characterImportMode === 'WHEAD'" id="character-import-panel-floating" @click.stop>
						<div class="header"><b>Wowhead Import</b></div>
						<input type="text" v-model="chrImportWowheadURL" placeholder="Wowhead Dressing Room URL"/>
						<input type="button" value="Import Character" @click="click('import-wowhead', $event)" :class="{ disabled: isBusy }"/>
					</div>
					<div class="left-panel">
						<template v-if="!chrShowGeosetControl">
							<label class="ui-select-label">
								<span class="select-prefix"><span class="prefix-label">Race:</span> <span class="prefix-value">{{ chrCustRaceSelection[0]?.label }}</span></span>
								<select class="ui-select" id="select-chr-race" :value="chrCustRaceSelection[0]?.id" @change="chrCustRaceSelection = [$event.target.value ? chrCustRaces.find(r => r.id === parseInt($event.target.value)) : chrCustRaces[0]]">
									<option value="" disabled selected style="display:none;"></option>
									<optgroup label="Playable Races">
										<option v-for="race in chrCustRacesPlayable" :key="race.id" :value="race.id">{{ race.label }}</option>
									</optgroup>
									<optgroup label="NPC Races">
										<option v-for="race in chrCustRacesNPC" :key="race.id" :value="race.id">{{ race.label }}</option>
									</optgroup>
								</select>
							</label>
							<label class="ui-select-label">
								<span class="select-prefix"><span class="prefix-label">Body:</span> <span class="prefix-value">{{ chrCustModelSelection[0]?.label }}</span></span>
								<select class="ui-select" id="select-chr-body" :value="chrCustModelSelection[0]?.id" @change="chrCustModelSelection = [$event.target.value ? chrCustModels.find(m => m.id === parseInt($event.target.value)) : chrCustModels[0]]">
									<option value="" disabled selected style="display:none;"></option>
									<option v-for="model in chrCustModels" :key="model.id" :value="model.id">{{ model.label }}</option>
								</select>
							</label>
							<template v-for="option in chrCustOptions" :key="option.id">
								<label v-if="!option.is_color_swatch" class="ui-select-label">
									<span class="select-prefix"><span class="prefix-label">{{ option.label }}:</span> <span class="prefix-value">{{ optionToChoices.get(option.id)?.find(c => c.id === chrCustActiveChoices.find(ac => ac.optionID === option.id)?.choiceID)?.label }}</span></span>
									<select class="ui-select" :value="chrCustActiveChoices.find(c => c.optionID === option.id)?.choiceID" @change="updateChoiceForOption(option.id, parseInt($event.target.value))">
										<option value="" disabled selected style="display:none;"></option>
										<option v-for="choice in optionToChoices.get(option.id)" :key="choice.id" :value="choice.id">{{ choice.label }}</option>
									</select>
								</label>
								<div v-else class="customization-color-container">
									<div class="customization-color-label" @click="toggleColorPicker(option.id, $event)">
										<span class="prefix-label">{{ option.label }}:</span>
										<div class="customization-color-selected">
											<div v-if="getSelectedChoice(option.id)?.swatch_color_0 === 0 && getSelectedChoice(option.id)?.swatch_color_1 === 0" class="swatch swatch-none">
												<div class="swatch-none-line"></div>
											</div>
											<div v-else-if="getSelectedChoice(option.id)?.swatch_color_1 !== 0" class="swatch swatch-dual">
												<div class="swatch-color-half-1" :style="{backgroundColor: intToCssColor(getSelectedChoice(option.id)?.swatch_color_0)}"></div>
												<div class="swatch-color-half-2" :style="{backgroundColor: intToCssColor(getSelectedChoice(option.id)?.swatch_color_1)}"></div>
											</div>
											<div v-else class="swatch swatch-single" :style="{backgroundColor: intToCssColor(getSelectedChoice(option.id)?.swatch_color_0)}"></div>
										</div>
									</div>
									<div v-if="colorPickerOpenFor === option.id" class="color-picker-popup" :style="{left: colorPickerPosition.x + 'px', top: colorPickerPosition.y + 'px'}" @click.self="colorPickerOpenFor = null">
											<div class="color-picker-grid">
												<div
													v-for="choice in optionToChoices.get(option.id)"
													:key="choice.id"
													:class="['swatch', 'swatch-clickable', {selected: chrCustActiveChoices.find(c => c.optionID === option.id)?.choiceID === choice.id}]"
													@click="selectColorChoice(option.id, choice.id)">
													<div v-if="choice.swatch_color_0 === 0 && choice.swatch_color_1 === 0" class="swatch-none">
														<div class="swatch-none-line"></div>
													</div>
													<div v-else-if="choice.swatch_color_1 !== 0" class="swatch-dual">
														<div class="swatch-color-half-1" :style="{backgroundColor: intToCssColor(choice.swatch_color_0)}"></div>
														<div class="swatch-color-half-2" :style="{backgroundColor: intToCssColor(choice.swatch_color_1)}"></div>
													</div>
													<div v-else class="swatch-single" :style="{backgroundColor: intToCssColor(choice.swatch_color_0)}"></div>
												</div>
											</div>
									</div>
								</div>
							</template>
							<label class="ui-select-label">
								<span class="select-prefix"><span class="prefix-label">Underwear:</span> <span class="prefix-value">{{ config.chrIncludeBaseClothing ? 'Visible' : 'Hidden' }}</span></span>
								<select class="ui-select" :value="config.chrIncludeBaseClothing" @change="config.chrIncludeBaseClothing = $event.target.value === 'true'">
									<option value="" disabled selected style="display:none;"></option>
									<option value="true">Visible</option>
									<option value="false">Hidden</option>
								</select>
							</label>
							<p id="chrCustUnsupportedText" v-show="chrCustUnsupportedWarning">Options with * use unsupported features and might not display/export correctly.</p>
							<span class="chr-geoset-toggle" @click="chrShowGeosetControl = true">Custom Geoset Control</span>
						</template>
						<template v-else>
							<div class="geoset-checkboxes">
								<label v-for="geoset in chrCustGeosets" :key="geoset.id" class="geoset-checkbox-item" v-show="geoset.id !== 0">
									<span class="geoset-prefix">{{ geoset.label }}:</span>
									<input type="checkbox" v-model="geoset.checked"/>
								</label>
							</div>
							<div class="geoset-toggles">
								<a @click="setAllGeosets(true, chrCustGeosets)">Enable All</a> / <a @click="setAllGeosets(false, chrCustGeosets)">Disable All</a>
							</div>
							<span class="chr-geoset-toggle" @click="chrShowGeosetControl = false">Return to Customization</span>
						</template>
					</div>
					<div class="char-preview preview-container">
						<div class="preview-background">
							<div v-if="chrModelLoading" class="chr-model-loading-spinner"></div>
							<model-viewer :context="chrModelViewerContext"></model-viewer>
							<div v-if="chrCustBakedNPCTexture" style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); z-index: 100;">
								<input type="button" value="Remove Baked Texture" @click="click('remove-baked-npc-texture', $event)" style="background-color: #d9534f; color: white; border: none; padding: 8px 16px; cursor: pointer; font-weight: bold;"/>
							</div>
						</div>
						<div class="texture-preview-panel" id="chr-texture-preview" v-show="config.chrShowTextureOverlay">
							<div id="chr-overlay-btn">
								<input type="button" value="&gt;" @click="click('chr-next-overlay', $event)"/>
								<input type="button" value="&lt;" @click="click('chr-prev-overlay', $event)"/>
							</div>
						</div>
						<div class="character-export-controls">
							<label class="ui-checkbox" title="Include Animations in Export">
								<input type="checkbox" v-model="config.modelsExportAnimations"/>
								<span>Export animations</span>
							</label>
							<label class="ui-checkbox" title="Render Shadow">
								<input type="checkbox" v-model="config.chrRenderShadow"/>
								<span>Render shadow</span>
							</label>
							<label class="ui-checkbox" title="Show Texture Overlay">
								<input type="checkbox" v-model="config.chrShowTextureOverlay"/>
								<span>Show texture overlay</span>
							</label>
							<menu-button :options="menuButtonCharacterExport" :default="config.exportCharacterFormat" @change="config.exportCharacterFormat = $event" :disabled="isBusy" @click="click('export-character', $event)"></menu-button>
						</div>
					</div>
					<!-- right-panel removed, geosets commented out for now -->
					<!--
					<div class="right-panel">
						<div v-if="chrCustRightTab == 'geosets'">
							<div class="header"><b>Geosets</b></div>
							<p>Only touch geosets <b>after</b> customizing the character to prevent conflicts.</p>
							<checkboxlist id="checkbox-geosets" :items="chrCustGeosets"></checkboxlist>
							<div class="list-toggles">
								<a @click="setAllGeosets(true, chrCustGeosets)">Enable All</a> / <a @click="setAllGeosets(false, chrCustGeosets)">Disable All</a>
							</div>
						</div>
					</div>
					-->
				</div>
				<div class="tab list-tab" id="tab-install" v-if="screen === 'tab-install'">
					<div class="list-container">
						<listbox v-model:selection="selectionInstall" :items="listfileInstall" :filter="userInputFilterInstall" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="install file" persistscrollkey="install"></listbox>
					</div>
					<div id="tab-install-tray">
						<div class="filter">
							<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
							<input type="text" v-model="userInputFilterInstall" placeholder="Filter install files..."/>
						</div>
						<input type="button" value="Export Selected" @click="click('export-install', $event)" :class="{ disabled: isBusy }"/>
					</div>
					<div class="sidebar">
						<label v-for="tag in installTags" class="ui-checkbox">
							<input type="checkbox" v-model="tag.enabled"/>
							<span>{{ tag.label }}</span>
						</label>
					</div>
				</div>
				<div class="tab list-tab" id="tab-raw" v-if="screen === 'tab-raw'">
					<div class="list-container">
						<listbox v-model:selection="selectionRaw" :items="listfileRaw" :filter="userInputFilterRaw" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="file" persistscrollkey="raw"></listbox>
					</div>
					<div id="tab-raw-tray">
						<div class="filter">
							<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
							<input type="text" v-model="userInputFilterRaw" placeholder="Filter raw files..."/>
						</div>
						<input type="button" value="Auto-Detect Selected" @click="click('detect-raw', $event)" :class="{ disabled: isBusy }"/>
						<input type="button" value="Export Selected" @click="click('export-raw', $event)" :class="{ disabled: isBusy }"/>
					</div>
				</div>
				<div class="tab list-tab" id="tab-video" v-if="screen === 'tab-video'">
					<div class="list-container">
						<listbox v-model:selection="selectionVideos" :items="listfileVideos" :filter="userInputFilterVideos" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="video" persistscrollkey="videos"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterVideos" placeholder="Filter videos..."/>
					</div>
					<div class="preview-container">
						<div class="preview-background" id="video-preview">
							<canvas id="video-preview-canvas" style="width: auto; height: auto; max-width: 100%; max-height: 100%; object-fit: contain; background: #000;"></canvas>
						</div>
					</div>
					<div class="preview-controls">
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.videoPlayerAutoPlay"/>
							<span>Autoplay</span>
						</label>
						<input type="button" :value="videoPlayerState ? 'Stop Preview' : 'Preview Selected'" @click="click('preview-video', $event)"/>
						<div class="tray"></div>
						<input type="button" value="Export Selected" @click="click('export-video', $event)" :class="{ disabled: isBusy }"/>
					</div>
				</div>
				<div class="tab list-tab" id="tab-text" v-if="screen === 'tab-text'">
					<div class="list-container">
						<listbox v-model:selection="selectionText" :items="listfileText" :filter="userInputFilterText" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="text file" persistscrollkey="text"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterText" placeholder="Filter text files..."/>
					</div>
					<div class="preview-container">
						<div class="preview-background" id="model-preview">
							<pre>{{ textViewerSelectedText }}</pre>
						</div>
					</div>
					<div class="preview-controls">
						<input type="button" value="Copy to Clipboard" @click="click('copy-text', $event)"/>
						<input type="button" value="Export Selected" @click="click('export-text', $event)" :class="{ disabled: isBusy }"/>
					</div>
				</div>
				<div class="tab list-tab" id="tab-sounds" v-if="screen === 'tab-sounds'">
					<div class="list-container">
						<listbox v-model:selection="selectionSounds" :items="listfileSounds" :filter="userInputFilterSounds" :keyinput="true" :regex="config.regexFilters" :copymode="config.copyMode" :pasteselection="config.pasteSelection" :copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="true" unittype="sound file" persistscrollkey="sounds"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterSounds" placeholder="Filter sound files..."/>
					</div>
					<div id="sound-player">
						<div id="sound-player-anim" :style="{ 'animation-play-state': soundPlayerState ? 'running' : 'paused' }"></div>
						<div id="sound-player-controls">
							<div id="sound-player-info">
								<span>{{ soundPlayerSeekFormatted }}</span>
								<span class="title">{{ soundPlayerTitle }}</span>
								<span>{{ soundPlayerDurationFormatted }}</span>
							</div>
							<slider id="slider-seek" v-model="soundPlayerSeek" @update:model-value="emit('click-sound-seek', $event)"></slider>
							<div class="buttons">
								<input type="button" :class="{ isPlaying: !soundPlayerState }" @click="click('sound-toggle', $event)"/>
								<slider id="slider-volume" v-model="config.soundPlayerVolume"></slider>
							</div>
						</div>
					</div>
					<div class="preview-controls">
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.soundPlayerLoop"/>
							<span>Loop</span>
						</label>
						<label class="ui-checkbox">
							<input type="checkbox" v-model="config.soundPlayerAutoPlay"/>
							<span>Autoplay</span>
						</label>
						<input type="button" value="Export Selected" @click="click('export-sound', $event)" :class="{ disabled: isBusy }"/>
					</div>
				</div>
				<div class="tab list-tab" id="tab-data" v-if="screen === 'tab-data'">
					<div class="list-container">
						<listbox v-model:selection="selectionDB2s" :items="dbdManifest" :filter="userInputFilterDB2s" :keyinput="true"
							:regex="config.regexFilters" :copydir="config.copyFileDirectories" :pasteselection="config.pasteSelection"
							:copytrimwhitespace="config.removePathSpacesCopy" :includefilecount="false" unittype="db2 file" :single="true"></listbox>
					</div>
					<div class="filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" v-model="userInputFilterDB2s" placeholder="Filter DB2s.." />
					</div>
					<div class="list-container">
						<data-table :headers="tableBrowserHeaders" :rows="tableBrowserRows" :filter="userInputFilterDataTable" :regex="config.regexFilters" :selection="selectionDataTable" @update:filter="userInputFilterDataTable = $event" @update:selection="selectionDataTable = $event"></data-table>
					</div>
					<div class="filter data-table-filter">
						<div class="regex-info" v-if="config.regexFilters" :title="regexTooltip">Regex Enabled</div>
						<input type="text" id="data-table-filter-input" v-model="userInputFilterDataTable" placeholder="Filter data table rows..." />
					</div>
					<div class="right-panel">
						<span class="header">Export</span>
						<label class="ui-checkbox" title="Export all rows">
							<input type="checkbox" v-model="config.dataExportAll"/>
							<span>Export all rows</span>
						</label>
						<div class="right-panel-buttons">
							<input type="button" value="Export as CSV" @click="click('export-data-csv', $event)" :class="{ disabled: isBusy || !tableBrowserHeaders || tableBrowserHeaders.length === 0 }"/>
							<input type="button" value="Export DB2" @click="click('export-db2-raw', $event)" :class="{ disabled: isBusy || !tableBrowserHeaders || tableBrowserHeaders.length === 0 }"/>
						</div>
					</div>
				</div>
				<div id="source-select" v-if="screen === 'source-select'">
					<div id="source-local" @click="click('source-local', $event)">
						<div class="source-icon"></div>
						<div class="source-content">
							<div class="source-title">Open Local Installation (Recommended)</div>
							<div class="source-subtitle">Explore a locally installed World of Warcraft installation on your machine</div>
							<div v-if="config.recentLocal && config.recentLocal.length > 0" class="source-last-opened">
								Last Opened: <span class="link" @click.stop="click('source-local-recent', $event, config.recentLocal[0])">{{ config.recentLocal[0].path }} ({{ getProductTag(config.recentLocal[0].product) }})</span>
							</div>
						</div>
					</div>
					<div id="source-remote" @click="click('source-remote', $event)">
						<div class="source-icon"></div>
						<div class="source-content">
							<div class="source-title">Use Battle.net CDN</div>
							<div class="source-subtitle">Explore available builds without installation directly from the Battle.net servers</div>
							<div class="source-cdn-region">
								Region: {{ selectedCDNRegion.name }} <span class="link" @click.stop="contextMenus.stateCDNRegion = true">(<span>Change</span>)</span>
							</div>
							<context-menu @close="contextMenus.stateCDNRegion = false" :node="contextMenus.stateCDNRegion" id="menu-cdn-region">
								<span v-for="region in cdnRegions" @click.self="setSelectedCDN(region)">
									{{ region.name }}
									<span v-if="region.delay !== null" style="opacity: 0.7; font-size: 12px;">{{ region.delay < 0 ? 'N/A' : region.delay + 'ms' }}</span>
								</span>
							</context-menu>
						</div>
					</div>
					<div id="source-legacy" @click="click('source-legacy', $event)">
						<div class="source-icon"></div>
						<div class="source-content">
							<div class="source-title">Open Legacy Installation</div>
							<div class="source-subtitle">Explore a legacy MPQ-based installation on your machine</div>
							<div v-if="config.recentLegacy && config.recentLegacy.length > 0" class="source-last-opened">
								Last Opened: <span class="link" @click.stop="click('source-legacy-recent', $event, config.recentLegacy[0])">{{ config.recentLegacy[0].path }}</span>
							</div>
						</div>
					</div>
				</div>
				<div id="build-select" v-if="screen === 'build-select'">
					<div class="build-select-content">
						<div class="build-select-title">Select Build</div>
						<div class="build-select-buttons">
							<input v-for="(build, i) in (availableLocalBuilds || availableRemoteBuilds)" @click="click('source-build', $event, i)" :class="['expansion-icon-bg-' + build.expansionId, { disabled: isBusy }]" type="button" :value="build.label"/>
						</div>
						<span @click="click('return-to-source-select', $event)" class="link build-select-return">Return to Installations</span>
					</div>
				</div>
			</div>
			<div id="footer">
				<template v-if="screen === 'config'">
					<div id="config-buttons">
						<input type="button" value="Discard" :class="{ disabled: isBusy }" @click="click('config-discard', $event)"/>
						<input type="button" value="Apply" :class="{ disabled: isBusy }" @click="click('config-apply', $event)"/>
						<input type="button" id="config-reset" value="Reset to Defaults" :class="{ disabled: isBusy }" @click="click('config-reset', $event)"/>
					</div>
				</template>
				<template v-else>
					<span id="footer-links">
						<a data-external="::WEBSITE">Website</a> - 
						<a data-external="::DISCORD">Discord</a> - 
						<a data-external="::PATREON">Patreon</a> - 
						<a data-external="::GITHUB">GitHub</a>
					</span>
					<span id="footer-copyright">
						World of Warcraft and related trademarks are registered trademarks of Blizzard Entertainment whom this application is not affiliated with.
					</span>
				</template>
			</div>
		</div>
		<noscript>
			<div id="crash-screen">
				<h1>Oh no! The kākāpō has exploded...</h1>
				<div id="crash-screen-versions">
					<span id="crash-screen-version">???</span>
					<span id="crash-screen-flavour">???</span>
					<span id="crash-screen-build">???</span>
				</div>
				<div id="crash-screen-text">
					<span id="crash-screen-text-code">ERR_BROKEN:</span>
					<span id="crash-screen-text-message">Something went so terribly wrong that we don't even have an error message.</span>
				</div>
				<div class="form-tray">
					<input type="button" value="Report Issue" data-external="::ISSUE_TRACKER"/>
					<input type="button" value="Get Help on Discord" data-external="::DISCORD"/>
					<input type="button" value="Restart Application" onclick="chrome.runtime.reload()"/>
				</div>
				<textarea id="crash-screen-log">No runtime log available.</textarea>
			</div>
		</noscript>
	</body>
</html>
